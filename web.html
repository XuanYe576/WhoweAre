<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"><title>Fake-3D Hallway</title><style>html,body{margin:0;padding:0;overflow:hidden;background:#030304}canvas{display:block;width:100vw;height:100vh}#ui{position:fixed;inset:0;pointer-events:none;font-family:Arial,sans-serif;color:#ccc}#reticle{position:absolute;left:50%;top:50%;width:6px;height:6px;margin:-3px 0 0 -3px;background:#ff4444;border-radius:50%}#notePrompt{position:fixed;bottom:12px;left:12px;font-size:12px;opacity:.5}</style></head><body><div id="warning" style="position:fixed;inset:0;background:rgba(0,0,0,.9);color:#fdd;display:flex;flex-direction:column;align-items:center;justify-content:center;font-family:Arial,sans-serif;font-size:18px;z-index:10;text-align:center;padding:20px;"><div style="max-width:720px;margin-bottom:20px;line-height:1.4;"><strong>WARNING: PHOTOSENSITIVITY/EPILEPSY/SEIZURES</strong><br><br>READ THIS NOTICE BEFORE PLAYING.<br>Some individuals may experience epileptic seizures or blackouts due to exposure to flashing lights or patterns, even without a history of epilepsy. Consult a physician before playing if you or a family member have a history of epilepsy or seizures. Discontinue playing and seek medical attention if symptoms like dizziness, altered vision, or convulsions occur. Resume gameplay only with a doctor's approval. Precautions like sitting further from the screen, using a smaller screen, playing in a well-lit room, and avoiding gameplay when drowsy can reduce risk. Parents should be aware of these symptoms in children.</div><button id="ackBtn" style="padding:10px 20px;font-size:16px;background:#400;color:#fdd;border:1px solid #700;cursor:pointer;">I understand</button></div><canvas id="c"></canvas><div id="ui"><div id="reticle"></div><div id="notePrompt">WASD move â€¢ N add note</div></div><script>const canvas=document.getElementById('c'),ctx=canvas.getContext('2d'),warning=document.getElementById('warning'),ackBtn=document.getElementById('ackBtn');let warningAlpha=1,warningDismissed=!1;ackBtn.onclick=()=>{warningDismissed=!0};const player={x:0,z:-6,y:1.6,speed:7},hall={width:9,height:16,depth:32},notes=[],keys={},moveInput={x:0,z:0},lookDelta={x:0,y:0};let yaw=0,pitch=0,mode="normal",modeTimer=0,pointerLocked=!1,touchLookId=null,lastTouch=null;function resize(){canvas.width=innerWidth;canvas.height=innerHeight}addEventListener('resize',resize);resize();function clamp(v,min,max){return Math.max(min,Math.min(max,v));}function snapNote(n){n.x=n.x>=0?hall.width/2:-hall.width/2;n.y=clamp(n.y||1,1,hall.height-1);n.z=clamp(n.z||1,.5,hall.depth-1);return n;}function seedNotes(){const seeds=["hello","hi","anyone?","echo","still there?"];for(let i=0;i<seeds.length;i++){const left=Math.random()<.5;notes.push(snapNote({text:seeds[i],x:left?-hall.width/2:hall.width/2,y:1+Math.random()*(hall.height-2),z:2+Math.random()*(hall.depth-4)}))}}function loadNotes(){fetch('notes.json').then(r=>{if(!r.ok)throw 0;return r.json();}).then(data=>{if(Array.isArray(data))data.forEach(d=>{if(d&&d.text)notes.push(snapNote({text:d.text,x:d.x||0,y:d.y||1,z:d.z||1}));});}).catch(()=>{}).then(()=>{if(!notes.length)seedNotes();});}loadNotes();function addNote(){const txt=prompt("Note text?");if(!txt)return;notes.push(snapNote({text:txt,x:Math.random()<.5?-hall.width/2:hall.width/2,y:1+Math.random()*(hall.height-2),z:player.z+6}))}addEventListener('keydown',e=>{keys[e.code]=!0;if(mode!=="normal")return;if(e.code==='KeyN')addNote();if(e.code==='Digit1'&&atEnd()){mode="overwhelm";modeTimer=0}if(e.code==='Digit2'&&atEnd()){const html=`<!doctype html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><style>html,body{margin:0;padding:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#0b0c10;color:#f5f5f5;font-family:Arial,sans-serif;}.msg{max-width:640px;text-align:center;font-size:22px;line-height:1.5;padding:20px;}</style></head><body><div class="msg">Some social life is good. Don't overwhelm yourself.</div></body></html>`;const nt=window.open('','_blank');if(nt&&nt.document){nt.document.write(html);nt.document.close();try{window.close()}catch(_){} }else{mode="overwhelm";modeTimer=0}}});addEventListener('keyup',e=>{keys[e.code]=!1});canvas.addEventListener('click',()=>{if(!pointerLocked&&canvas.requestPointerLock)canvas.requestPointerLock()});document.addEventListener('pointerlockchange',()=>{pointerLocked=document.pointerLockElement===canvas});addEventListener('mousemove',e=>{if(!pointerLocked)return;lookDelta.x+=e.movementX*.0025;lookDelta.y-=e.movementY*.002});canvas.addEventListener('touchstart',e=>{if(touchLookId!==null)return;const t=e.touches[0];touchLookId=t.identifier;lastTouch={x:t.clientX,y:t.clientY}},{passive:!1});canvas.addEventListener('touchmove',e=>{if(touchLookId===null)return;for(let i=0;i<e.touches.length;i++){const t=e.touches[i];if(t.identifier===touchLookId){const dx=t.clientX-lastTouch.x,dy=t.clientY-lastTouch.y;lookDelta.x+=dx*.004;lookDelta.y-=dy*.003;lastTouch={x:t.clientX,y:t.clientY};break}}},{passive:!1});canvas.addEventListener('touchend',e=>{for(let i=0;i<e.changedTouches.length;i++){if(e.changedTouches[i].identifier===touchLookId){touchLookId=null;lastTouch=null;break}}});function atEnd(){return player.z>hall.depth-3}function project(x,y,z){const dx=x-player.x,dy=y-player.y,dz=z-player.z,cosY=Math.cos(yaw),sinY=Math.sin(yaw),cosP=Math.cos(pitch),sinP=Math.sin(pitch),rx=dx*cosY-dz*sinY,rz=dx*sinY+dz*cosY,ry=dy,ry2=ry*cosP-rz*sinP,rz2=ry*sinP+rz*cosP;if(rz2<=.1)return null;const f=420/rz2;return{x:canvas.width/2+rx*f,y:canvas.height/2-ry2*f}}function drawQuad(p1,p2,p3,p4,fill,stroke){if(!p1||!p2||!p3||!p4)return;ctx.beginPath();ctx.moveTo(p1.x,p1.y);ctx.lineTo(p2.x,p2.y);ctx.lineTo(p3.x,p3.y);ctx.lineTo(p4.x,p4.y);ctx.closePath();ctx.fillStyle=fill;ctx.fill();if(stroke){ctx.strokeStyle=stroke;ctx.stroke()}}function step(dt){yaw+=lookDelta.x;pitch+=lookDelta.y;lookDelta.x=0;lookDelta.y=0;const mp=Math.PI/2-.05;if(pitch>mp)pitch=mp;if(pitch<-mp)pitch=-mp;const move={x:0,z:0};if(keys['KeyW'])move.z+=1;if(keys['KeyS'])move.z-=1;if(keys['KeyA'])move.x-=1;if(keys['KeyD'])move.x+=1;const len=Math.hypot(move.x,move.z);if(len>.001){move.x/=len;move.z/=len;player.x+=move.x*player.speed*dt;player.z+=move.z*player.speed*dt;player.x=Math.max(-hall.width/2+.5,Math.min(hall.width/2-.5,player.x));player.z=Math.max(-8,Math.min(hall.depth-.8,player.z))}}function render(){ctx.fillStyle='#050507';ctx.fillRect(0,0,canvas.width,canvas.height);const grd=ctx.createLinearGradient(0,0,0,canvas.height);grd.addColorStop(0,'#0d0f16');grd.addColorStop(1,'#050507');ctx.fillStyle=grd;ctx.fillRect(0,canvas.height/2,canvas.width,canvas.height/2);for(let z=hall.depth;z>=0;z-=2){const lx=-hall.width/2,rx=hall.width/2,y0=0,y1=hall.height,p1=project(lx,y0,z),p2=project(rx,y0,z),p3=project(rx,y1,z),p4=project(lx,y1,z),shade=Math.max(.1,1-z/hall.depth);drawQuad(p1,p2,p3,p4,`rgba(26,30,50,${shade})`,'rgba(50,60,90,0.2)')}const bw1=project(-hall.width/2,0,hall.depth),bw2=project(hall.width/2,0,hall.depth),bw3=project(hall.width/2,hall.height,hall.depth),bw4=project(-hall.width/2,hall.height,hall.depth);drawQuad(bw1,bw2,bw3,bw4,'rgba(20,24,38,0.9)','rgba(60,70,100,0.4)');ctx.strokeStyle='rgba(80,80,120,0.4)';for(let x=-hall.width/2;x<=hall.width/2;x+=1){const p0=project(x,0,0),p1=project(x,0,hall.depth);if(p0&&p1){ctx.beginPath();ctx.moveTo(p0.x,p0.y);ctx.lineTo(p1.x,p1.y);ctx.stroke()}}for(let z=0;z<=hall.depth;z+=2){const p0=project(-hall.width/2,0,z),p1=project(hall.width/2,0,z);if(p0&&p1){ctx.beginPath();ctx.moveTo(p0.x,p0.y);ctx.lineTo(p1.x,p1.y);ctx.stroke()}}for(let i=0;i<notes.length;i++){const n=notes[i],sz=.5,off=Math.sign(n.x)*.05,p1=project(n.x-off,n.y-sz/2,n.z-sz/2),p2=project(n.x-off,n.y-sz/2,n.z+sz/2),p3=project(n.x-off,n.y+sz/2,n.z+sz/2),p4=project(n.x-off,n.y+sz/2,n.z-sz/2);drawQuad(p1,p2,p3,p4,'#fff772','rgba(0,0,0,0.5)');if(p1&&p3){const cx=(p1.x+p3.x)/2,cy=(p1.y+p3.y)/2,text=n.text.slice(0,12),tw=ctx.measureText(text).width;ctx.fillStyle='rgba(255,0,0,0.8)';ctx.font='10px Arial';ctx.fillText(text,cx-tw/2,cy+4)}}if(atEnd()){const msg1="Who are you?",msg2="1) social",msg3="2) yourself";ctx.fillStyle='rgba(0,0,0,0.4)';ctx.fillRect(canvas.width/2-120,canvas.height/2-50,240,80);ctx.strokeStyle='rgba(200,200,255,0.4)';ctx.strokeRect(canvas.width/2-120,canvas.height/2-50,240,80);ctx.fillStyle='#fff';ctx.font='14px Arial';ctx.fillText(msg1,canvas.width/2-ctx.measureText(msg1).width/2,canvas.height/2-20);ctx.fillStyle='#fff';ctx.fillText(msg2,canvas.width/2-ctx.measureText(msg2).width/2,canvas.height/2);ctx.fillText(msg3,canvas.width/2-ctx.measureText(msg3).width/2,canvas.height/2+20)}if(mode==="overwhelm"){ctx.fillStyle='rgba(0,0,0,0.8)';ctx.fillRect(0,0,canvas.width,canvas.height);ctx.font='18px Arial';ctx.fillStyle='#fff';if(notes.length===0){ctx.fillText("No notes yet.",20,40)}else{for(let i=0;i<60;i++){const n=notes[i%notes.length],x=Math.random()*canvas.width,y=Math.random()*canvas.height;ctx.fillStyle='#f44';ctx.fillText(n.text,x,y)}}const t=Math.max(0,3-modeTimer).toFixed(1);ctx.fillStyle='#f55';ctx.fillText("Overwhelmed... closing soon ("+t+"s)",canvas.width/2-140,canvas.height-30)}}let last=performance.now();function loop(now){const dt=(now-last)/1000;last=now;if(warningDismissed&&warningAlpha>0){warningAlpha=Math.max(0,warningAlpha-dt*1.2);warning.style.opacity=warningAlpha.toFixed(2);if(warningAlpha<=0)warning.style.display='none'}step(dt);if(mode==="overwhelm"){modeTimer+=dt;if(modeTimer>3){try{window.close()}catch(_){} }}render();requestAnimationFrame(loop)}requestAnimationFrame(loop);</script></body></html>
